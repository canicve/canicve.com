---
tags:
  - linux_userspace
  - privesc

coverage:
  cve: CVE-2021-3156
  links:
    - DIRECT: https://www.sudo.ws/security/advisories/unescape_overflow/
    - DIRECT: https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt
    - DIRECT: https://oss-security.openwall.org/wiki/vendors
    - DIRECT: https://github.com/reverse-ex/CVE-2021-3156/blob/main/cve-2021-3156--2021-01-26-1453.sh
    - EDB: 40847
    - EDB: 40839
    - GH: blasty/CVE-2021-3156
    - GH: worawit/CVE-2021-3156
    - GHG: rbauchdo990/874b1cc52a1b39e0ce646fc81208d44d
    - TENABLE
    - RHEL
    - DEBIAN
    - UBUNTU
    - SUSE
    - NVD
    - MITRE
    - CVD
    - ORACLE
    - R7
    - MARC
    - GENTOO
    - GHCS
  vulnerable:
    - UBUNTU:
        - "20.10":
            ARCHITECTURE:
                - x86_64
                - x86
            SOFTWARE:
                - sudo-1.9.1-1ubuntu1.1
                - sudo-ldap-1.9.1-1ubuntu1.1
        - "20.04":
            ARCHITECTURE:
                - x86_64
                - x86
            SOFTWARE:
                - sudo-1.8.31-1ubuntu1.2:
                    - GH: blasty/CVE-2021-3156
                    - DIRECT: https://github.com/worawit/CVE-2021-3156/blob/main/exploit_nss.py
                - sudo-ldap-1.8.31-1ubuntu1.2:
                    - GH: blasty/CVE-2021-3156
                    - DIRECT: https://github.com/worawit/CVE-2021-3156/blob/main/exploit_nss.py
        - "18.04":
            ARCHITECTURE:
                - x86_64
                - x86
            SOFTWARE:
                - sudo-1.8.21p2-3ubuntu1.4:
                    - GH: blasty/CVE-2021-3156
                    - DIRECT: https://github.com/worawit/CVE-2021-3156/blob/main/exploit_nss.py
                - sudo-ldap-1.8.21p2-3ubuntu1.4:
                    - GH: blasty/CVE-2021-3156
                    - DIRECT: https://github.com/worawit/CVE-2021-3156/blob/main/exploit_nss.py
        - "16.04":
            ARCHITECTURE:
                - x86_64
                - x86
            SOFTWARE:
                - sudo-1.8.16-0ubuntu1.10:
                    - DIRECT: https://github.com/worawit/CVE-2021-3156/blob/main/exploit_nss_u16.py
                    - DIRECT: https://github.com/worawit/CVE-2021-3156/blob/main/exploit_userspec.py
                - sudo-ldap-1.8.16-0ubuntu1.10:
                    - DIRECT: https://github.com/worawit/CVE-2021-3156/blob/main/exploit_nss_u16.py
                    - DIRECT: https://github.com/worawit/CVE-2021-3156/blob/main/exploit_userspec.py
        - "14.04":
            ARCHITECTURE:
                - x86_64
                - x86
            SOFTWARE:
                - sudo-1.8.9p5-1ubuntu1.5+esm6:
                    - DIRECT: https://github.com/worawit/CVE-2021-3156/blob/main/exploit_nss_u14.py
        - "12.04":
            ARCHITECTURE:
                - x86_64
                - x86
            SOFTWARE:
                - sudo-1.8.3p1-1ubuntu3.10
    - RHEL:
        - "5":
            ARCHITECTURE:
                - x86_64
                - x86
            SOFTWARE:
                - 'sudo-1.6.7p5-30.1.1'
                - 'sudo-1.6.7p5-30.1.3'
                - 'sudo-1.6.7p5-30.1.5'
                - 'sudo-1.6.7p5-30.1'
                - 'sudo-1.6.8p12-10'
                - 'sudo-1.6.8p12-12.el5'
                - 'sudo-1.6.9p17-3.el5'
                - 'sudo-1.6.9p17-3.el5_3.1'
                - 'sudo-1.6.9p17-5.el5'
                - 'sudo-1.6.9p17-6.el5_4'
                - 'sudo-1.7.2p1-5.el5'
                - 'sudo-1.7.2p1-6.el5_5'
                - 'sudo-1.7.2p1-7.el5_5'
                - 'sudo-1.7.2p1-8.el5_5'
                - 'sudo-1.7.2p1-9.el5_5'
                - 'sudo-1.7.2p1-10.el5'
                - 'sudo-1.7.2p1-13.el5'
                - 'sudo-1.7.2p1-14.el5_8.2'
                - 'sudo-1.7.2p1-14.el5_8.3'
                - 'sudo-1.7.2p1-14.el5_8.4'
                - 'sudo-1.7.2p1-14.el5_8'
                - 'sudo-1.7.2p1-19.el5'
                - 'sudo-1.7.2p1-22.el5'
                - 'sudo-1.7.2p1-22.el5_9.1'
                - 'sudo-1.7.2p1-28.el5'
                - 'sudo-1.7.2p1-29.el5_10'
                - 'sudo-1.7.2p1-30.el5_11'
                - 'sudo-1.7.2p1-31.el5_11.1'
                - 'sudo-1.7.2p1-31.el5_11'
    - RHEL:
        - "6":
            ARCHITECTURE:
                - x86_64
                - x86
            SOFTWARE:
                - 'sudo-1.7.2p2-9.el6'
                - 'sudo-1.7.4p5-5.el6'
                - 'sudo-1.7.4p5-6.el6_1'
                - 'sudo-1.7.4p5-7.el6'
                - 'sudo-1.7.4p5-9.el6_2'
                - 'sudo-1.7.4p5-11.el6'
                - 'sudo-1.7.4p5-12.el6_3'
                - 'sudo-1.7.4p5-13.el6_3.1'
                - 'sudo-1.7.4p5-13.el6_3'
                - 'sudo-1.8.6p3-7.el6'
                - 'sudo-1.8.6p3-12.el6'
                - 'sudo-1.8.6p3-12.el6_5.2'
                - 'sudo-1.8.6p3-15.el6'
                - 'sudo-1.8.6p3-15.el6_6.2'
                - 'sudo-1.8.6p3-19.el6'
                - 'sudo-1.8.6p3-20.el6_7'
                - 'sudo-1.8.6p3-24.el6'
                - 'sudo-1.8.6p3-25.el6_8'
                - 'sudo-1.8.6p3-27.el6'
                - 'sudo-1.8.6p3-28.el6_9'
                - 'sudo-1.8.6p3-29.el6_9'
                - 'sudo-1.8.6p3-29.el6_10.2'
                - 'sudo-1.8.6p3-29.el6_10.3'
    - RHEL:
        - "7":
            ARCHITECTURE:
                - x86_64
                - x86
            SOFTWARE:
                - 'sudo-1.8.6p7-7.el7'
                - 'sudo-1.8.6p7-11.el7'
                - 'sudo-1.8.6p7-13.el7'
                - 'sudo-1.8.6p7-13.ael7b'
                - 'sudo-1.8.6p7-16.el7'
                - 'sudo-1.8.6p7-17.el7_2.2'
                - 'sudo-1.8.6p7-17.el7_2'
                - 'sudo-1.8.6p7-20.el7'
                - 'sudo-1.8.6p7-21.el7_3'
                - 'sudo-1.8.6p7-22.el7_3'
                - 'sudo-1.8.6p7-23.el7_3.2'
                - 'sudo-1.8.6p7-23.el7_3'
                - 'sudo-1.8.19p2-10.el7'
                - 'sudo-1.8.19p2-11.el7_4'
                - 'sudo-1.8.19p2-12.el7_4.1'
                - 'sudo-1.8.19p2-12.el7_4'
                - 'sudo-1.8.19p2-13.el7'
                - 'sudo-1.8.19p2-14.el7_5.1'
                - 'sudo-1.8.19p2-14.el7_5'
                - 'sudo-1.8.23-1.el7'
                - 'sudo-1.8.23-3.el7'
                - 'sudo-1.8.23-3.el7_6.1'
                - 'sudo-1.8.23-4.el7'
                - 'sudo-1.8.23-4.el7_7.1'
                - 'sudo-1.8.23-4.el7_7.2'
                - 'sudo-1.8.23-9.el7'
                - 'sudo-1.8.23-10.el7'
    - RHEL:
        - "8":
            ARCHITECTURE:
                - x86_64
                - x86
            SOFTWARE:
                - 'sudo-1.8.25p1-4.el8'
                - 'sudo-1.8.25p1-4.el8_0.1'
                - 'sudo-1.8.25p1-4.el8_0.2'
                - 'sudo-1.8.25p1-4.el8_0.3'
                - 'sudo-1.8.25p1-7.el8'
                - 'sudo-1.8.25p1-8.el8_1.1'
                - 'sudo-1.8.25p1-8.el8_1'
                - 'sudo-1.8.29-5.el8'
                - 'sudo-1.8.29-6.el8'
---

# Baron Samedit

Dependent upon [glibc version](https://www.gnu.org/software/libc/) and [sudo version](https://www.sudo.ws/releases/stable/).